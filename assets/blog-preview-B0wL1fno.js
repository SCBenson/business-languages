import{u as a}from"./vue-core-DwdlfoAd.js";import{r as e,c as t,B as l,a0 as s,q as r,a2 as o,ai as i,F as u,a1 as c,a8 as n,a3 as v,a4 as d,a6 as h,a5 as g,S as m,ae as p,aj as f,ak as b,al as y,am as w,an as x,ao as I}from"./vendor-B_vSI__U.js";import{_,D as k,S as D}from"./index-BLZ2Ov8X.js";import{s as P,b as U,a as $,o as j,p as C,x as H,y as B,h as T,F as V}from"./vuetify-DoYrIMr4.js";/* empty css              */const F={class:""},N={class:"text-start text-white"},S={class:"text-white"},q={class:"text-white"},z={class:"ma-4"},E={key:0},L={key:1},W=_({__name:"blog-preview",setup(_){const W=a(),A=e(!1),G=e({show:!1,text:"",color:"info"}),J=e({avatarPath:"",author:"",id:"",title:"",date:"",initialHeader:"",initialParagraph:"",coverImageUrl:"",contentItems:[]}),K=t((()=>{const a=J.value.coverImageUrl;return a?{backgroundImage:`linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url('${a}')`}:{backgroundImage:"linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url('@/assets/hero-background.png')"}}));l((()=>{history.state&&history.state.blogData&&(J.value=history.state.blogData)}));const M=()=>{W.back()},O=()=>{return a=this,e=null,t=function*(){A.value=!0;const a=p(k,"blog-posts"),e=J.value.title.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").substring(0,60);try{let l=new Date;if(J.value.formattedDate){const a=J.value.formattedDate.replace(/(\d+)(st|nd|rd|th)/,"$1"),e=new Date(a);isNaN(l.getTime())&&(l=e)}let s="";if(J.value.coverImageUrl&&J.value.coverImageUrl.startsWith("blob:"))try{const a=yield fetch(J.value.coverImageUrl),t=yield a.blob(),l=f(D,`blog-images/${e}-${Date.now()}`);yield b(l,t),s=yield y(l)}catch(t){s=J.value.coverImageUrl}else s=J.value.coverImageUrl||"";const r=yield w(a,{avatar:J.value.avatarPath,author:J.value.author,formattedDate:J.value.formattedDate||"",date:x.fromDate(l),title:J.value.title,initialHeader:J.value.initialHeader,initialParagraph:J.value.initialParagraph,contentItems:J.value.contentItems,coverImageUrl:s,slug:e});yield I(r,{id:r.id}),J.value.id=r.id,G.value={show:!0,text:"Blog post published successfully!",color:"success"},setTimeout((()=>{W.push(`/blog/${e}`)}),1500),setTimeout((()=>{W.replace(`/blog/${e}`).catch((a=>{}))}),3e3)}catch(t){G.value={show:!0,text:`Publishing failed: ${t.messages}`,color:"error"}}finally{A.value=!1}},new Promise(((l,s)=>{var r=a=>{try{i(t.next(a))}catch(e){s(e)}},o=a=>{try{i(t.throw(a))}catch(e){s(e)}},i=a=>a.done?l(a.value):Promise.resolve(a.value).then(r,o);i((t=t.apply(a,e)).next())}));var a,e,t};return(a,e)=>(c(),s(u,null,[r(P,{class:"header-section",style:i(K.value)},{default:o((()=>[r($,{class:"mx-2"},{default:o((()=>[r(j,{class:"align-start"},{default:o((()=>[r(C,{class:""},{default:o((()=>[n("div",F,[n("h1",N,h(J.value.title),1),n("h2",S,h(J.value.formattedDate),1),J.value.avatarPath?(c(),v(H,{key:0,size:"80"},{default:o((()=>[r(B,{src:J.value.avatarPath},null,8,["src"])])),_:1})):d("",!0),n("p",q,"By: "+h(J.value.author),1)])])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),r(U,{class:"overlapping-card ma-6",color:"#f4b754"},{default:o((()=>[n("div",z,[n("h2",null,h(J.value.initialHeader),1),n("p",null,h(J.value.initialParagraph),1),(c(!0),s(u,null,g(J.value.contentItems,((a,e)=>(c(),s("div",{key:e},["header"===a.type?(c(),s("h2",E,h(a.content),1)):d("",!0),"paragraph"===a.type?(c(),s("p",L,h(a.content),1)):d("",!0)])))),128))]),r(T,{onClick:M,color:"blue"},{default:o((()=>e[2]||(e[2]=[m("Edit Content")]))),_:1}),r(T,{onClick:O,color:"green"},{default:o((()=>e[3]||(e[3]=[m("Publish")]))),_:1}),r(V,{modelValue:G.value.show,"onUpdate:modelValue":e[1]||(e[1]=a=>G.value.show=a),color:G.value.color},{actions:o((()=>[r(T,{variant:"text",onClick:e[0]||(e[0]=a=>G.value.show=!1)},{default:o((()=>e[4]||(e[4]=[m("Close")]))),_:1})])),default:o((()=>[m(h(G.value.text)+" ",1)])),_:1},8,["modelValue","color"])])),_:1})],64))}},[["__scopeId","data-v-3c460b4d"]]);export{W as default};
